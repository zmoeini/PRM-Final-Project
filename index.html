<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System 3JS</title>
</head>
<style>
    body{
        margin:0;
        height:100%;
        background: black;
        overflow: hidden;
        font:14px system-ui;
    }
    #ui{
        position:fixed;
        left:10px;
        top:10px;
        color:white;
        background: black;
        padding: 6px 10px;
        border-radius:8px ;
    }
     #info {
        position: absolute;
        top: 10px;
        left: 10px;
    }

</style>
<script type="importmap">
    {
        "imports":
            {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js"
            }
    }
</script>
<body>
     <div id="info">Click a celestial body to learn more!</div>

     <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/controls/OrbitControls.js';


        // minimal state 
        let time = 30;
        let score = 0;
        let running = true;

        // ---- three---- setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0b0d12);
        const camera = new THREE.PerspectiveCamera(55, innerWidth/innerHeight, 0.1, 100);
        camera.position.set(0,6,8);
        camera.lookAt(0,0,0);

        const renderer = new THREE.WebGLRenderer({antialias:true});
        renderer.setSize(innerWidth, innerHeight);
        // where we should show the render in html in which element --- add to body 
        document.body.appendChild(renderer.domElement);
        // resize ---Event 
        addEventListener('resize',() =>
            {
                camera.aspect= innerWidth/innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(innerWidth, innerHeight);
            }
        );

        // HemisphereLight 
        const light = new THREE.HemisphereLight(0x9ecfff,0x0b0d12,0.9);
        scene.add(light);
        const dl = new THREE.DirectionalLight(0xffffff,0.7);
        dl.position.set(3,6,4);
        scene.add(dl);

        //Controls
        const controls = new OrbitControls(camera, renderer.domElement);

        //Raycast + pointer
        const raycaster = new THREE.Raycaster();
        const pointer = new THREE.Vector2(); //mouse pos

        const sun = new THREE.Mesh (
        new THREE.SphereGeometry(0.8), new THREE.MeshBasicMaterial({color: 0xFFDA21}));
        scene.add(sun); 

        //add some vfx
        const sunGlow = new THREE.PointLight(0xFFDA21, 30, 200);
        sunGlow.position.set(0,0,0);
        scene.add(sunGlow);
    
        const mercury = makePlanet("mercury", 0.2, {color: 0xC0C0C0}, 2);
        makeRing(1.5);

        const venus = makePlanet("venus", 0.3, {color: 0xDBB48A}, 3);
        makeRing(2.5);

        const earth = makePlanet("earth", 0.3, {color: 0x4592B0}, 5);
        makeRing(4);

        const moon = makePlanet("moon", 0.1, {color: 0xEDEDED}, 5.4);

        const mars = makePlanet("mars", 0.2, {color: 0xA12C02}, 6);
        makeRing(6);

        
      
    
        //click on celestial object
        addEventListener('pointerdown', (event)=>
    {
         pointer.x = (event.clientX / innerWidth)*2 -1;
         pointer.y = -(event.clientY / innerHeight)*2 + 1;
         raycaster.setFromCamera(pointer, camera);

         const hit = raycaster.intersectObjects([sun,venus,earth,mars,moon])[0];

            if (hit) document.getElementById('info').innerText = "You viewed: " + 
                (hit.object === sun ? "the Sun" :
                hit.object === venus ? "Venus" :
                hit.object === earth ? "Earth" :
                hit.object === mars ? "Mars" :
                "the Moon");
            
        });

        //Anims func
        function loop(){
            requestAnimationFrame(loop);

            mercury.position.x= 1.5 * Math.cos(Date.now()*0.001);
            mercury.position.z = 1.5 * Math.sin(Date.now() * 0.001);

            venus.position.x= 2.5 * Math.cos(Date.now()*0.001);
            venus.position.z = 2.5 * Math.sin(Date.now() * 0.001);

            earth.position.x= 4 * Math.cos(Date.now()*0.001);
            earth.position.z = 4 * Math.sin(Date.now() * 0.001);
            moon.position.x = earth.position.x + 0.4 * Math.cos (Date.now() * 0.005);
            moon.position.z = earth.position.z + 0.4 * Math.sin (Date.now() * 0.005);

            mars.position.x= 6 * Math.cos(Date.now()*0.001);
            mars.position.z = 6 * Math.sin(Date.now() * 0.001);

            //update the controls
            controls.update();
            //render view
            renderer.render(scene, camera);
        }

        loop(); //call funct

function makePlanet(name, size, color, distance){
        const object = new THREE.Mesh (
        new THREE.SphereGeometry(size), new THREE.MeshStandardMaterial(color));
        object.position.x = distance;
        //distance from the sun /\
        scene.add(object);
        object.name = name;
        return object;
}

function makeRing(distance) { //distance from the sun
  
    var orbitPoints = []; //connect dots to make ring, stored here

    for (var i = 0; i < 60; i++) { //our circle will have 60 pts (denotes how smooth it is)
        var angle = (i / 60) * Math.PI * 2; //divvy up our circle in 60 pts
        orbitPoints.push(new THREE.Vector3(Math.cos(angle) * distance, 0, Math.sin(angle) * distance));
    }

    var ringGeo= new THREE.BufferGeometry(); //container for shapes ie points and lines
    ringGeo.setFromPoints(orbitPoints); //make shape out of our pts
    var ringMat = new THREE.LineBasicMaterial({color: 0xffffff }); //orbit ring is white
    var orbitRing = new THREE.LineLoop(ringGeo, ringMat); //combine color and geo for ring

    scene.add(orbitRing);
    return orbitRing;
}
        
        </script>
</body>
</html>